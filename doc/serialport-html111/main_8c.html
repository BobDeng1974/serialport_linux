<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Serial Port: /home/latelee/test/serialport_linux/src/main.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.8 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>/home/latelee/test/serialport_linux/src/main.c File Reference</h1>A simple test of serial port writing data to the port. <a href="#_details">More...</a>
<p>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &lt;pthread.h&gt;</code><br>
<code>#include &lt;signal.h&gt;</code><br>
<code>#include "<a class="el" href="debug-msg_8h-source.html">debug-msg.h</a>"</code><br>
<code>#include "<a class="el" href="serialport_8h-source.html">serialport.h</a>"</code><br>
<table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="main_8c.html#a4">write_port_thread</a> (void *argc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="main_8c.html#a5">read_port_thread</a> (void *argc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="main_8c.html#a6">sig_handle</a> (int sig_num)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="a7" doxytag="main.c::main" ></a>
int&nbsp;</td><td class="memItemRight" valign=bottom><b>main</b> (void)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>pthread_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="main_8c.html#a0">write_tid</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>pthread_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="main_8c.html#a1">read_tid</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>char *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="main_8c.html#a2">buf</a> = "Are you going to die? "</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>char&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="main_8c.html#a3">tmp</a> [512]</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A simple test of serial port writing data to the port. 
<p>
Copyleft (C) 2010 Late Lee This program is tested on LINUX PLATFORM, WITH GCC 4.x. The program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY. Please feel free to use the program, and I feel free to ignore the related issues. Any questions or suggestions, or bugs, please contact me at &lt;$ echo -n "aHR0cDovL3d3dy5sYXRlbGVlLm9yZwo=" | base64 -d&gt; or e-mail to &lt;$ echo -n "bGF0ZWxlZUAxNjMuY29tCg==" | base64 -d&gt; if you want to do this.<p>
<dl compact><dt><b>Author:</b></dt><dd>Late Lee </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>Mon Jan 10 2011</dd></dl>
<p>
<dl compact><dt><b><a class="el" href="test.html#_test000002">Test:</a></b></dt><dd>To compile the program, type <code> gcc <a class="el" href="main_8c.html">main.c</a> <a class="el" href="serialport_8c.html">serialport.c</a> -lthread </code>,then it will generate the executable binary <code>a.out</code>. To run it, type <code> ./a.out</code>.Make sure you have the permission to open the serial port.<br>
 You can start a ternimal and type <code>minicom</code>(also make sure you can open the device). When everything is OK, you can see the data in minicom using the same port if you connect pin 2 &amp; pin 3 of the port (the male connector, see the picture below)(but I don't know the reason, isn't it blocked?).<br>
 If you want to stop the program, just use 'Ctrl+c'. <br>
 Here are snapshots of the program:</dd></dl>
<div align="center">
<img src="serial-write.jpg" alt="serial-write.jpg">
<p><strong>Writing to the port...</strong></p></div>
 <div align="center">
<img src="serial-read-minicom.jpg" alt="serial-read-minicom.jpg">
<p><strong>Reading the data in minicom...</strong></p></div>
 <br>
 And here comes the serial port connector: <div align="center">
<img src="com-male.jpg" alt="com-male.jpg">
<p><strong>A 9-pin male D-Sub connector(*)</strong></p></div>
 <div align="center">
<img src="com-female.jpg" alt="com-female.jpg">
<p><strong>A 9-pin female D-Sub connector</strong></p></div>
 (*)We use this connector in the test.<hr><h2>Function Documentation</h2>
<a class="anchor" name="a5" doxytag="main.c::read_port_thread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void* read_port_thread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>argc</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
read_port_thread - Thread that reads data from the port<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>argc</em>&nbsp;</td><td>: Here means the port(specified by the fd).</td></tr>
  </table>
</dl>
<dl compact><dt><b>Note:</b></dt><dd>This function has not tested yet. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="main.c::sig_handle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void sig_handle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sig_num</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
sig_handle - Handle the INT signal.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>sig_num</em>&nbsp;</td><td>: The signal. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Note:</b></dt><dd>This function is not used. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="main.c::write_port_thread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void* write_port_thread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>argc</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
write_port_thread - A thread that writes data to the port<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>argc</em>&nbsp;</td><td>: Here means the port(specified by the fd).</td></tr>
  </table>
</dl>
<dl compact><dt><b>Note:</b></dt><dd>This is only a test, not the <em>real</em> one. </dd></dl>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a2" doxytag="main.c::buf" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char* <a class="el" href="main_8c.html#a2">buf</a> = "Are you going to die? "          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The data we write to the port.     </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="main.c::read_tid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> pthread_t <a class="el" href="main_8c.html#a1">read_tid</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
read thread     </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="main.c::tmp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char <a class="el" href="main_8c.html#a3">tmp</a>[512]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
data we receive     </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="main.c::write_tid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> pthread_t <a class="el" href="main_8c.html#a0">write_tid</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
write thread     </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sun Apr 7 12:56:56 2013 for Serial Port by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.8 </small></address>
</body>
</html>
